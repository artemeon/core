<div class="container">
    {% set wid = 0 %}
    {% for widget in widgets %}
        <div class="row">
            <div class="col-xs-2">
                <div style="margin: 10px 10px 10px 10px; height:60px">{{ widget['img']|raw }}</div>
                <div style="padding-top:10px; text-align: center; font-weight: 600">{{ widget['name'] }}</div>
            </div>
            <div style="border-left:1px solid lightgrey; height:100px" class="col-xs-7 hidden-xs">{{ widget['info'] }}</div>
            <div style="border-left:1px solid lightgrey; height:100px" class="col-xs-3">
                <button id="addWidget" class="btn" onclick="showColumnSelect({{ wid }})">Add</button>
                <div id="selectColumn{{ wid }}" style="display: none" class="btn-toolbar" role="toolbar">
                    <div class="btn-group mr-2" role="group" aria-label="First group">
                        <button type="button" class="btn btn-secondary" onclick="addWidgetToDashboard('{{ widget['class']|e('js') }}', 1)">1</button>
                        <button type="button" class="btn btn-secondary" onclick="addWidgetToDashboard('{{ widget['class']|e('js') }}', 2)">2</button>
                        <button type="button" class="btn btn-secondary" onclick="addWidgetToDashboard('{{ widget['class']|e('js') }}', 3)">3</button>
                    </div>
                    <div class="btn-group mr-2" role="group" aria-label="Second group">
                        <button type="button" class="btn btn-secondary" onclick="hideColumnSelect({{ wid }})">Ã—</button>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        {% set wid = wid + 1 %}
    {% endfor %}
</div>
<script>

    function showColumnSelect(widgetId) {
        $("button#addWidget").hide();
        $("div#selectColumn"+widgetId).show();
    }

    function hideColumnSelect(widgetId) {
        $("div#selectColumn"+widgetId).hide();
        $("button#addWidget").show();
    }

    function addWidgetToDashboard(widgetClass, column) {
        var data = "&step=3&widget="+widgetClass+"&column=column"+column+"&ajax=true";
        require(['ajax', 'router'], function (ajax, router) {
            ajax.genericAjaxCall("dashboard", "addWidgetToDashboard", data, null, function() {
                if (window.opener) {
                    window.close();
                } else if (parent) {
                    var context = parent.require('folderview');
                    parent.require("router").reload();
                    if (context.dialog) {
                        context.dialog.hide();
                        context.dialog.setContentRaw("");
                    }
                }
            });
        });
    }

</script>
